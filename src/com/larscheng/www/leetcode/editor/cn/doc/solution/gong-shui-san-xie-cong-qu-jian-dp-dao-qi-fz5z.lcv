## Âå∫Èó¥ DP

Ê≤øÁî® [95. ‰∏çÂêåÁöÑ‰∫åÂèâÊêúÁ¥¢Ê†ë II](https://www.acoier.com/2022/12/09/95.%20%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%20II%EF%BC%88%E4%B8%AD%E7%AD%89%EF%BC%89/) ÁöÑÂü∫Êú¨ÊÄùË∑ØÔºåÂè™‰∏çËøáÊú¨È¢ò‰∏çÊòØÊ±ÇÂÖ∑‰ΩìÊñπÊ°àÔºåËÄåÊòØÊ±Ç‰∏™Êï∞„ÄÇ

Èô§‰∫ÜËÉΩÁî® [95. ‰∏çÂêåÁöÑ‰∫åÂèâÊêúÁ¥¢Ê†ë II](https://www.acoier.com/2022/12/09/95.%20%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%20II%EF%BC%88%E4%B8%AD%E7%AD%89%EF%BC%89/) ÊèêÂà∞ÁöÑ„ÄåÂç°ÁâπÂÖ∞Êï∞„ÄçÁõ¥Êé•Ê±ÇËß£ $n$ ‰∏™ËäÇÁÇπÁöÑ‰ª•Â§ñÔºåÊú¨È¢òËøòËÉΩÈÄöËøáÂ∏∏ËßÑ„ÄåÂå∫Èó¥ DP„ÄçÁöÑÊñπÂºèËøõË°åÊ±ÇËß£„ÄÇ

> Ê±ÇÊï∞Èáè‰ΩøÁî® DPÔºåÊ±ÇÊâÄÊúâÂÖ∑‰ΩìÊñπÊ°à‰ΩøÁî®ÁàÜÊêúÔºåÊòØÊûÅÂÖ∂Â∏∏ËßÅÁöÑ‰∏ÄÈ¢òÂ§öÈóÆÊê≠ÈÖç„ÄÇ

**ÂÆö‰πâ $f[l][r]$ ‰∏∫‰ΩøÁî®Êï∞ÂÄºËåÉÂõ¥Âú® $[l, r]$ ‰πãÈó¥ÁöÑËäÇÁÇπÔºåÊâÄËÉΩÊûÑÂª∫ÁöÑ `BST` ‰∏™Êï∞**„ÄÇ

‰∏çÂ§±‰∏ÄËà¨ÊÄßËÄÉËôë $f[l][r]$ ËØ•Â¶Ç‰ΩïÊ±ÇËß£Ôºå‰ªçÁî® $[l, r]$ ‰∏≠ÁöÑÊ†πËäÇÁÇπ `i` ‰∏∫‰ΩïÂÄºÔºå‰Ωú‰∏∫ÂàáÂÖ•ÁÇπËøõË°åÊÄùËÄÉ„ÄÇ

Ê†πÊçÆ„Äå`BST` ÂÆö‰πâ„ÄçÂèä„Äå‰πòÊ≥ïÂéüÁêÜ„ÄçÂèØÁü•Ôºö$[l, i - 1]$ Áõ∏ÂÖ≥ËäÇÁÇπÊûÑÊàêÁöÑ `BST`  Â≠êÊ†ëÂè™ËÉΩÂú® `i` ÁöÑÂ∑¶ËæπÔºåËÄå $[i + 1, r]$ Áõ∏ÂÖ≥ËäÇÁÇπÊûÑÊàêÁöÑ `BST`  Â≠êÊ†ëÂè™ËÉΩÂú® `i` ÁöÑÂè≥Ëæπ„ÄÇÊâÄÊúâÁöÑÂ∑¶Âè≥Â≠êÊ†ëÁõ∏‰∫íÁã¨Á´ãÔºåÂõ†Ê≠§‰ª• `i` ‰∏∫Ê†πËäÇÁÇπÁöÑ `BST` Êï∞Èáè‰∏∫ $f[l][i - 1] \times f[i + 1][r]$ÔºåËÄå `i` ÂÖ±Êúâ $r - l + 1$ ‰∏™ÂèñÂÄºÔºà$i \in [l, r]$Ôºâ„ÄÇ

Âç≥ÊúâÔºö
$$
f[l][r] = \sum_{i = l}^{r} (f[l][i - 1] \times f[i + 1][r])
$$
‰∏çÈöæÂèëÁé∞ÔºåÊ±ÇËß£Âå∫Èó¥ $[l, r]$ ÁöÑ `BST`  Êï∞Èáè $f[l][r]$ ‰æùËµñ‰∫éÊØîÂÖ∂Â∞èÁöÑÂå∫Èó¥ $[l, i - 1]$ Âíå $[i + 1, r]$ÔºåËøôÂºïÂØºÊàë‰ª¨‰ΩøÁî®„ÄåÂå∫Èó¥ DP„ÄçÁöÑÊñπÂºèËøõË°åÈÄíÊé®„ÄÇ

> ‰∏ç‰∫ÜËß£Âå∫Èó¥ DP ÁöÑÂêåÂ≠¶ÔºåÂèØÁúã [ÂâçÁΩÆ üßÄ](https://mp.weixin.qq.com/s/RuIKpDEuxkhhKiTeVRMXng)

‰∏Ä‰∫õÁªÜËäÇÔºöÁî±‰∫éÊàë‰ª¨ `i` ÁöÑÂèñÂÄºÂèØËÉΩ‰ºöÂèñÂà∞Âå∫Èó¥‰∏≠ÁöÑÊúÄÂÄº `l` Âíå `r`Ôºå‰∏∫‰∫ÜËÉΩÂ§üËØ•ÊÉÖÂÜµ‰∏ãÔºå$f[l][i - 1]$ Âíå $f[i + 1][r]$ ËÉΩÂ§üÈ°∫Âà©ÂèÇ‰∏éËΩ¨ÁßªÔºåËµ∑ÂßãÊàë‰ª¨ÈúÄË¶ÅÂÖàÂØπÊâÄÊúâÊª°Ë∂≥ $i >= j$ ÁöÑ $f[i][j]$ ÂàùÂßãÂåñ‰∏∫ `1`„ÄÇ

‰ª£Á†ÅÔºö

* []

```Java
class Solution {
    public int numTrees(int n) {
        int[][] f = new int[n + 10][n + 10];
        for (int i = 0; i <= n + 1; i++) {
            for (int j = 0; j <= n + 1; j++) {
                if (i >= j) f[i][j] = 1;
            }
        }
        for (int len = 2; len <= n; len++) {
            for (int l = 1; l + len - 1 <= n; l++) {
                int r = l + len - 1;
                for (int i = l; i <= r; i++) {
                    f[l][r] += f[l][i - 1] * f[i + 1][r];
                }
            }
        }
        return f[1][n];
    }
}
```

* []

```C++
class Solution {
public:
    int numTrees(int n) {
        vector<vector<int>> f(n + 2, vector<int>(n + 2, 0));
        for (int i = 0; i <= n + 1; i++) {
            for (int j = 0; j <= n + 1; j++) {
                if (i >= j) f[i][j] = 1;
            }
        }
        for (int len = 2; len <= n; len++) {
            for (int l = 1; l + len - 1 <= n; l++) {
                int r = l + len - 1;
                for (int i = l; i <= r; i++) {
                    f[l][r] += f[l][i - 1] * f[i + 1][r];
                }
            }
        }
        return f[1][n];
    }
};
```

* []

```Python
class Solution(object):
    def numTrees(self, n):
        f = [[0] * (n + 2) for _ in range(n + 2)]
        for i in range(n + 2):
            for j in range(n + 2):
                if i >= j:
                    f[i][j] = 1
        for length in range(2, n + 1):
            for l in range(1, n - length + 2):
                r = l + length - 1
                for i in range(l, r + 1):
                    f[l][r] += f[l][i - 1] * f[i + 1][r]
        return f[1][n]
```

* []

```TypeScript
function numTrees(n: number): number {
    const f = new Array(n + 2).fill(0).map(() => new Array(n + 2).fill(0));
    for (let i = 0; i <= n + 1; i++) {
        for (let j = 0; j <= n + 1; j++) {
            if (i >= j) f[i][j] = 1;
        }
    }
    for (let len = 2; len <= n; len++) {
        for (let l = 1; l + len - 1 <= n; l++) {
            const r = l + len - 1;
            for (let i = l; i <= r; i++) {
                f[l][r] += f[l][i - 1] * f[i + 1][r];
            }
        }
    }
    return f[1][n];
};
```

* Êó∂Èó¥Â§çÊùÇÂ∫¶Ôºö$O(n^3)$
* Á©∫Èó¥Â§çÊùÇÂ∫¶Ôºö$O(n^2)$

---

## Âå∫Èó¥ DPÔºà‰ºòÂåñÔºâ

Ê±ÇËß£ÂÆå‰ΩøÁî® $[1, n]$ ÂÖ± $n$ ‰∏™ËøûÁª≠Êï∞ÊâÄËÉΩÊûÑÊàêÁöÑ `BST`  ‰∏™Êï∞ÂêéÔºåÂÜçÊù•ÊÄùËÄÉ‰∏Ä‰∏™ÈóÆÈ¢òÔºö‰ΩøÁî® $[L, R]$ ÂÖ± $n = R - L + 1$ ‰∏™ËøûÁª≠Êï∞ÔºåÊâÄËÉΩÊûÑÊàêÁöÑ `BST`  ‰∏™Êï∞ÂèàÊòØÂ§öÂ∞ë„ÄÇ

Á≠îÊ°àÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ

**Áî± $n$ ‰∏™ËøûÁª≠Êï∞ÊûÑÊàêÁöÑ `BST`  ‰∏™Êï∞‰ªÖ‰∏éÊï∞ÂÄº‰∏™Êï∞ÊúâÂÖ≥Á≥ªÔºå‰∏éÊï∞ÂÄºÂ§ßÂ∞èÊú¨Ë∫´Âπ∂Êó†ÂÖ≥Á≥ª**„ÄÇ

Áî±‰∫éÂèØÁü•ÔºåÊàë‰ª¨‰∏äËø∞ÁöÑ„ÄåÂå∫Èó¥ DP„ÄçÂøÖÁÑ∂ËøõË°å‰∫ÜÂ§ßÈáèÈáçÂ§çËÆ°ÁÆóÔºå‰æãÂ¶Ç $f[1][3]$ Âíå $f[2][4]$ Âêå‰∏∫Â§ßÂ∞è‰∏∫ $3$ ÁöÑÂå∫Èó¥ÔºåÂç¥Ë¢´ËÆ°ÁÆó‰∫Ü‰∏§Ê¨°„ÄÇ

Ë∞ÉÊï¥Êàë‰ª¨ÁöÑÁä∂ÊÄÅÂÆö‰πâÔºö**ÂÆö‰πâ $f[k]$ ‰∏∫ËÄÉËôëËøûÁª≠Êï∞‰∏™Êï∞‰∏∫ $k$ Êó∂ÔºåÊâÄËÉΩÊûÑÊàêÁöÑ `BST`  ÁöÑ‰∏™Êï∞**„ÄÇ

‰∏çÂ§±‰∏ÄËà¨ÊÄßËÄÉËôë $f[i]$ Â¶Ç‰ΩïËÆ°ÁÆóÔºå‰ªçÁî® $[1, i]$ ‰∏≠Âì™‰∏™Êï∞ÂÄº‰Ωú‰∏∫Ê†πËäÇÁÇπËøõË°åËÄÉËôë„ÄÇÂÅáËÆæ‰ΩøÁî®Êï∞ÂÄº $j$ ‰Ωú‰∏∫Ê†πËäÇÁÇπÔºåÂàôÊúâ $f[j - 1] \times f[i - j]$ ‰∏™ `BST` ÂèØË¥°ÁåÆÂà∞ $f[i]$ÔºåËÄå $j$ ÂÖ±Êúâ $i$ ‰∏™ÂèñÂÄºÔºà$j \in [1, i]$Ôºâ„ÄÇ

Âç≥ÊúâÔºö
$$
f[i] = \sum_{j = 1}^{i}(f[j - 1] \times f[i - j])
$$

ÂêåÊó∂ÊúâÂàùÂßãÂåñ $f[0] = 1$ÔºåÂê´‰πâ‰∏∫Ê≤°Êúâ‰ªª‰ΩïËøûÁª≠Êï∞Êó∂ÔºåÂè™Êúâ‚ÄúÁ©∫Ê†ë‚Äù‰∏ÄÁßçÂêàÊ≥ïÊñπÊ°à„ÄÇ

‰ª£Á†ÅÔºö

* []

```Java
class Solution {
    public int numTrees(int n) {
        int[] f = new int[n + 10];
        f[0] = 1;
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= i; j++) {
                f[i] += f[j - 1] * f[i - j];
            }
        }
        return f[n];
    }
}
```

* []

```C++
class Solution {
public:
    int numTrees(int n) {
        vector<int> f(n + 10, 0);
        f[0] = 1;
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= i; j++) {
                f[i] += f[j - 1] * f[i - j];
            }
        }
        return f[n];
    }
};
```

* []

```Python
class Solution:
    def numTrees(self, n: int) -> int:
        f = [0] * (n + 10)
        f[0] = 1
        for i in range(1, n + 1):
            for j in range(1, i + 1):
                f[i] += f[j - 1] * f[i - j]
        return f[n]
```

* []

```TypeScript
function numTrees(n: number): number {
    const f = new Array(n + 10).fill(0);
    f[0] = 1;
    for (let i = 1; i <= n; i++) {
        for (let j = 1; j <= i; j++) {
            f[i] += f[j - 1] * f[i - j];
        }
    }
    return f[n];
};
```

* Êó∂Èó¥Â§çÊùÇÂ∫¶Ôºö$O(n^2)$
* Á©∫Èó¥Â§çÊùÇÂ∫¶Ôºö$O(n)$

---

## Êï∞Â≠¶ - Âç°ÁâπÂÖ∞Êï∞

Âú®„ÄåÂå∫Èó¥ DPÔºà‰ºòÂåñÔºâ„Äç‰∏≠ÁöÑÈÄíÊé®ËøáÁ®ãÔºåÊ≠£ÊòØ‚ÄúÂç°ÁâπÂÖ∞Êï∞‚ÄùÁöÑ $O(n^2)$ ÈÄíÊé®ËøáÁ®ã„ÄÇÈÄöËøáÂØπÂ∏∏ËßÑ„ÄåÂå∫Èó¥ DP„ÄçÁöÑ‰ºòÂåñÔºåÊàë‰ª¨ÂæóËØÅ [95. ‰∏çÂêåÁöÑ‰∫åÂèâÊêúÁ¥¢Ê†ë II](https://www.acoier.com/2022/12/09/95.%20%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%20II%EF%BC%88%E4%B8%AD%E7%AD%89%EF%BC%89/) ‰∏≠„ÄåÁªôÂÆö $n$ ‰∏™ËäÇÁÇπÊâÄËÉΩÊûÑÊàêÁöÑ `BST`  ÁöÑ‰∏™Êï∞‰∏∫Âç°ÁâπÂÖ∞Êï∞„ÄçËøô‰∏ÄÁªìËÆ∫„ÄÇ

ÂØπ‰∫éÁ≤æÁ°ÆÊ±ÇÂç°ÁâπÂÖ∞Êï∞ÔºåÂ≠òÂú®Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ $O(n)$ ÁöÑÈÄöÈ°πÂÖ¨ÂºèÂÅöÊ≥ïÔºåÂÖ¨Âºè‰∏∫ $C_{n+1} = \frac{C_n \cdot (4n + 2)}{n + 2}$„ÄÇ

‰ª£Á†ÅÔºö

* []

```Java
class Solution {
    public int numTrees(int n) {
        if (n <= 1) return 1;
        long ans = 1;
        for (int i = 0; i < n; i++) ans = ans * (4 * i + 2) / (i + 2);
        return (int)ans;
    }
}
```

* []

```C++
class Solution {
public:
    int numTrees(int n) {
        if (n <= 1) return 1;
        long long ans = 1;
        for (int i = 0; i < n; i++) ans = ans * (4 * i + 2) / (i + 2);
        return (int)ans;
    }
};
```

* []

```Python
class Solution:
    def numTrees(self, n: int) -> int:
        if n <= 1:
            return 1
        ans = 1
        for i in range(n):
            ans = ans * (4 * i + 2) // (i + 2)
        return ans
```

* []

```TypeScript
function numTrees(n: number): number {
    if (n <= 1) return 1;
    let ans = 1;
    for (let i = 0; i < n; i++) ans = ans * (4 * i + 2) / (i + 2);
    return ans;
};
```

* Êó∂Èó¥Â§çÊùÇÂ∫¶Ôºö$O(n)$
* Á©∫Èó¥Â§çÊùÇÂ∫¶Ôºö$O(1)$

---

## ÊúÄÂêé

**Â¶ÇÊûúÊúâÂ∏ÆÂä©Âà∞‰Ω†ÔºåËØ∑ÁªôÈ¢òËß£ÁÇπ‰∏™ËµûÂíåÊî∂ËóèÔºåËÆ©Êõ¥Â§öÁöÑ‰∫∫ÁúãÂà∞ ~ ("‚ñî‚ñ°‚ñî)/**

ÊâÄÊúâÈ¢òËß£Â∑≤ÁªèÂä†ÂÖ• [Âà∑È¢òÊåáÂçó](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ÔºåÊ¨¢Ëøé star Âì¶ ~

